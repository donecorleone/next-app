import{useFrame as r}from"@studio-freight/hamo";import t from"@studio-freight/lenis";import e from"prop-types";import o,{createContext as n,forwardRef as i,useRef as a,useState as l,useCallback as c,useImperativeHandle as s,useEffect as u,useContext as f}from"react";import{create as p}from"zustand";function d(){return d=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])}return r},d.apply(this,arguments)}const m=["children","root","options","autoRaf","rafPriority"],b=n(),y=p(()=>({}));function h(r,t=[],e=0){const{lenis:o,addCallback:n,removeCallback:i}=function(){const r=f(b),t=y();return null!=r?r:t}();return u(()=>{if(r&&n&&i&&o)return n(r,e),r(o),()=>{i(r)}},[o,n,i,e,...t]),o}const v=i((e,n)=>{let{children:i,root:f=!1,options:p={},autoRaf:h=!0,rafPriority:v=0}=e,k=function(r,t){if(null==r)return{};var e,o,n={},i=Object.keys(r);for(o=0;o<i.length;o++)t.indexOf(e=i[o])>=0||(n[e]=r[e]);return n}(e,m);const g=a(),O=a(),[C,j]=l(),P=a([]),R=c((r,t)=>{P.current.push({callback:r,priority:t}),P.current.sort((r,t)=>r.priority-t.priority)},[]),w=c(r=>{P.current=P.current.filter(t=>t.callback!==r)},[]);s(n,()=>C,[C]),u(()=>{const r=new t(d({},p,!f&&{wrapper:g.current,content:O.current}));return j(r),()=>{r.destroy(),j(void 0)}},[f,JSON.stringify(p)]),r(r=>{h&&(null==C||C.raf(r))},v),u(()=>{f&&C&&y.setState({lenis:C,addCallback:R,removeCallback:w})},[f,C,R,w]);const E=c(r=>{for(let t=0;t<P.current.length;t++)P.current[t].callback(r)},[]);return u(()=>{if(C)return C.on("scroll",E),()=>{C.off("scroll",E)}},[C,E]),/*#__PURE__*/o.createElement(b.Provider,{value:{lenis:C,addCallback:R,removeCallback:w}},f?i:/*#__PURE__*/o.createElement("div",d({ref:g},k),/*#__PURE__*/o.createElement("div",{ref:O},i)))});v.displayName="ReactLenis",v.propTypes={children:e.node,root:e.bool,options:e.object,autoRaf:e.bool,rafPriority:e.number};export{v as Lenis,b as LenisContext,v as ReactLenis,h as useLenis};
//# sourceMappingURL=react-lenis.modern.mjs.map
